Type: #linux<br>
Level: #easy<br>
Link: <https://www.hackthebox.eu/machines/Bashed><br>
Tags : #TCM<br>
Tools: 

## Pentesting of retired HTB VM Bashed
### Following walkthrougt of TCM on udemy

### Scanning
```
Nmap scan report for 10.10.10.68
Host is up (0.037s latency).
Not shown: 65534 closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Arrexel's Development Site
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=6/5%OT=80%CT=1%CU=36710%PV=Y%DS=2%DC=T%G=Y%TM=60BB73D8
OS:%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10A%TI=Z%CI=I%II=I%TS=8)OPS(
OS:O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11
OS:NW7%O6=M54DST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(
OS:R=Y%DF=Y%T=40%W=7210%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS
OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=
OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=
OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T
OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=
OS:S)

Network Distance: 2 hops

TRACEROUTE (using port 110/tcp)
HOP RTT      ADDRESS
1   36.69 ms 10.10.14.1
2   36.35 ms 10.10.10.68

```
###  Enumeration
Info disclosure : `Apache 2.4.18`
Web server is up seemes to be a dedicated site leading us to the use of phpbash
### Exploitation
Using dirbuster, i've found the /dev/ folder with a phpbash file that gave us a shell as www-data, which was enough to get user flag.

Then using a simple http server with python and this reverse shell http://pentestmonkey.net/tools/web-shells/php-reverse-shell

I was able to wget the reverse file in the upload directory and get a TTY.

I accessed the scriptmanager via sudo -u scriptmanager /bin/bash

I've found the /scripts folder that belong to scriptmanager whre a file is generated from a .py every minute and the file has root permission.

Using a reverse python one liner I was able to open a reverse shell with root access.